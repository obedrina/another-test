version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
global_job_config:
  prologue:
    commands:
      - echo cole
blocks:
  - name: 'Block #1'
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - sudo service docker stop && sudo umount /var/lib/docker && sudo service docker start
            - cat /tmp/system-metrics
  - name: 'Block #2'
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - echo test > test.txt
            - echo test > test2.txt
            - artifact push job test.txt
            - artifact push job test2.txt
promotions:
  - name: Deploy
    pipeline_file: pipeline_2.yml
    parameters:
      env_vars:
        - required: true
          options:
            - Stage
            - Production
          default_value: Stage
          description: Where to deploy?
          name: ENVIRONMENT
