version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: Install deps
    dependencies: []
    task:
      jobs:
        - name: bundle
          commands:
            - checkout
            - make bundle
  - name: Static analysis
    dependencies: []
    task:
      jobs:
        - name: Rubocop
          commands:
            - checkout
            - make rubocop
        - name: Lint
          commands:
            - checkout
            - make lint
  - name: Unit tests
    dependencies:
      - Install deps
      - Static analysis
    task:
      jobs:
        - name: RSpec
          commands:
            - checkout
            - make rspec
          parallelism: 4
